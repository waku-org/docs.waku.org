"use strict";(self.webpackChunkwaku_guide=self.webpackChunkwaku_guide||[]).push([[6059],{3905:(t,e,a)=>{a.d(e,{Zo:()=>u,kt:()=>c});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var s=n.createContext({}),d=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):l(l({},e),t)),a},u=function(t){var e=d(t.components);return n.createElement(s.Provider,{value:e},t.children)},p="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},h=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,s=t.parentName,u=o(t,["components","mdxType","originalType","parentName"]),p=d(a),h=r,c=p["".concat(s,".").concat(h)]||p[h]||m[h]||i;return a?n.createElement(c,l(l({ref:e},u),{},{components:a})):n.createElement(c,l({ref:e},u))}));function c(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,l=new Array(i);l[0]=h;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=t,o[p]="string"==typeof t?t:r,l[1]=o;for(var d=2;d<i;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},92358:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const i={title:"Maximum Bandwidth for Global Adoption"},l=void 0,o={unversionedId:"research/research-and-studies/maximum-bandwidth",id:"research/research-and-studies/maximum-bandwidth",title:"Maximum Bandwidth for Global Adoption",description:"TLDR//github.com/waku-org/research/issues/22 to specify how this maximum will be enforced.",source:"@site/docs/research/research-and-studies/maximum-bandwidth.md",sourceDirName:"research/research-and-studies",slug:"/research/research-and-studies/maximum-bandwidth",permalink:"/research/research-and-studies/maximum-bandwidth",draft:!1,editUrl:"https://github.com/waku-org/docs.waku.org/tree/develop/docs/research/research-and-studies/maximum-bandwidth.md",tags:[],version:"current",lastUpdatedAt:1708340432,formattedLastUpdatedAt:"19 Feb 2024",frontMatter:{title:"Maximum Bandwidth for Global Adoption"},sidebar:"research",previous:{title:"Incentivisation",permalink:"/research/research-and-studies/incentivisation"},next:{title:"Message Propagation Times With Waku-RLN",permalink:"/research/research-and-studies/message-propagation"}},s={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Bandwidth availability and usage",id:"bandwidth-availability-and-usage",level:2},{value:"Selecting a maximum bandwidth",id:"selecting-a-maximum-bandwidth",level:2}],u={toc:d},p="wrapper";function m(t){let{components:e,...a}=t;return(0,r.kt)(p,(0,n.Z)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"TLDR"),": This issue aims to ",(0,r.kt)("strong",{parentName:"p"},"set the maximum bandwidth")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"x Mbps")," that each waku shard should consume so that the ",(0,r.kt)("strong",{parentName:"p"},"maximum amount of people can run a full waku node"),". It is up to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/22"},"https://github.com/waku-org/research/issues/22")," to specify how this maximum will be enforced."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Conclusion:")," Limit to ",(0,r.kt)("inlineCode",{parentName:"p"},"10 Mbps")," each waku shard."),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Waku is designed in a way that everyone should be able to run a full node on an average laptop with a residential Internet connection, at least in one shard. This will enable true decentralization and give power to the users, since they won't need to rely on third parties to send/receive messages. Professional node operators running in data centers, can of course contribute to multiple shards, but we should keep the bandwidth/hardware requirements of single shard rather low."),(0,r.kt)("p",null,"This vision opposes the federated approach, where a few nodes requiring vast amounts of resources (cpu, memory, bandwidth) run in data centres, taking the power from the user. While federated approaches are an improvement from traditional client-server architectures, waku envisions a fully peer-to-peer architecture where anyone should be able to run a node."),(0,r.kt)("p",null,"In order to ensure that anyone can run a node ",(0,r.kt)("strong",{parentName:"p"},"in desktop"),", there are two main ",(0,r.kt)("strong",{parentName:"p"},"limiting factors"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Bandwidth consumption in Mbps"),(0,r.kt)("li",{parentName:"ol"},"CPU/memory resources (mainly limited by RLN proof verification)")),(0,r.kt)("p",null,"This issue focuses on i) bandwidth consumption and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/30"},"https://github.com/waku-org/research/issues/30")," on ii) CPU/memory resources. Note that on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/23"},"https://github.com/waku-org/research/issues/23")," an analysis on the impact on RLN was already made, but wasn't focused on scalability. Said issues do."),(0,r.kt)("p",null,"In ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/22"},"https://github.com/waku-org/research/issues/22")," we discussed ",(0,r.kt)("strong",{parentName:"p"},"why")," and ",(0,r.kt)("strong",{parentName:"p"},"how")," to limit the maximum bandwidth per shard, but we haven't come up with a specific number in Mbps. ",(0,r.kt)("strong",{parentName:"p"},"This issue i) presents data from the available bandwidth at different locations and ii) suggests a maximum bandwidth in Mbps that waku should enforce"),"."),(0,r.kt)("h2",{id:"bandwidth-availability-and-usage"},"Bandwidth availability and usage"),(0,r.kt)("p",null,"The following tables show:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Table ","[1]"," The Q25, Q75 and average bandwidth (upload/download) in Mbps available on different continents. Raw data is available ",(0,r.kt)("a",{parentName:"li",href:"https://www.measurementlab.net/data/"},"here")," and credits to ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/leobago"},"@leobago")," for the summarized version. Note: The below numbers were rounded to the nearest integer."),(0,r.kt)("li",{parentName:"ul"},"Table ","[2]"," The median global bandwidth (upload/download) in Mbps, taken from ",(0,r.kt)("a",{parentName:"li",href:"https://www.speedtest.net/global-index"},"speedtest")," (accessed 12 Oct 2023). "),(0,r.kt)("li",{parentName:"ul"},"Table ","[3]"," Download bandwidth requirements in Mbps for Netflix video streaming, ",(0,r.kt)("a",{parentName:"li",href:"https://www.comparethemarket.com/broadband/content/broadband-for-streaming/"},"source"),".")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"Table ","[1]")),(0,r.kt)("th",{parentName:"tr",align:null},"Download (Mbps)"),(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Upload (Mbps)"),(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Q25")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Average")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Q75")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Q25")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Average")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Q75"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"North-America"),(0,r.kt)("td",{parentName:"tr",align:null},"58"),(0,r.kt)("td",{parentName:"tr",align:null},"107"),(0,r.kt)("td",{parentName:"tr",align:null},"137"),(0,r.kt)("td",{parentName:"tr",align:null},"38"),(0,r.kt)("td",{parentName:"tr",align:null},"68"),(0,r.kt)("td",{parentName:"tr",align:null},"85")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"South-America"),(0,r.kt)("td",{parentName:"tr",align:null},"21"),(0,r.kt)("td",{parentName:"tr",align:null},"54"),(0,r.kt)("td",{parentName:"tr",align:null},"72"),(0,r.kt)("td",{parentName:"tr",align:null},"13"),(0,r.kt)("td",{parentName:"tr",align:null},"33"),(0,r.kt)("td",{parentName:"tr",align:null},"44")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Europe"),(0,r.kt)("td",{parentName:"tr",align:null},"49"),(0,r.kt)("td",{parentName:"tr",align:null},"93"),(0,r.kt)("td",{parentName:"tr",align:null},"119"),(0,r.kt)("td",{parentName:"tr",align:null},"30"),(0,r.kt)("td",{parentName:"tr",align:null},"56"),(0,r.kt)("td",{parentName:"tr",align:null},"72")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Asia"),(0,r.kt)("td",{parentName:"tr",align:null},"23"),(0,r.kt)("td",{parentName:"tr",align:null},"53"),(0,r.kt)("td",{parentName:"tr",align:null},"71"),(0,r.kt)("td",{parentName:"tr",align:null},"15"),(0,r.kt)("td",{parentName:"tr",align:null},"37"),(0,r.kt)("td",{parentName:"tr",align:null},"50")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Oceania"),(0,r.kt)("td",{parentName:"tr",align:null},"44"),(0,r.kt)("td",{parentName:"tr",align:null},"84"),(0,r.kt)("td",{parentName:"tr",align:null},"108"),(0,r.kt)("td",{parentName:"tr",align:null},"27"),(0,r.kt)("td",{parentName:"tr",align:null},"50"),(0,r.kt)("td",{parentName:"tr",align:null},"63")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Africa"),(0,r.kt)("td",{parentName:"tr",align:null},"12"),(0,r.kt)("td",{parentName:"tr",align:null},"26"),(0,r.kt)("td",{parentName:"tr",align:null},"33"),(0,r.kt)("td",{parentName:"tr",align:null},"7"),(0,r.kt)("td",{parentName:"tr",align:null},"17"),(0,r.kt)("td",{parentName:"tr",align:null},"22")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"Table ","[2]")),(0,r.kt)("th",{parentName:"tr",align:null},"Median Download (Mbps)"),(0,r.kt)("th",{parentName:"tr",align:null},"Median Upload (Mbps)"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Global"),(0,r.kt)("td",{parentName:"tr",align:null},"83"),(0,r.kt)("td",{parentName:"tr",align:null},"38")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"Table ","[3]")," ",(0,r.kt)("strong",{parentName:"th"},"Video resolution")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"Recommended Bandwidth")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"HD"),(0,r.kt)("td",{parentName:"tr",align:null},"3 Mbps")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Full HD"),(0,r.kt)("td",{parentName:"tr",align:null},"5 Mbps")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4K/UHD"),(0,r.kt)("td",{parentName:"tr",align:null},"15 Mbps")))),(0,r.kt)("h2",{id:"selecting-a-maximum-bandwidth"},"Selecting a maximum bandwidth"),(0,r.kt)("p",null,"With the above data, we should be informed to take a decision on the maximum bandwidth that we should enforce per shard. With this number, we will apply the techniques explained in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/22"},"https://github.com/waku-org/research/issues/22")," to ensure (with some statistical confidence) that the bandwidth won't exceed that number."),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"trade-off is clear"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"We ",(0,r.kt)("strong",{parentName:"li"},"enforce a low bandwidth"),": more people can run full waku nodes, overall network throughput is less, network decentralization is easier, gives power to the user as its fully sovereign."),(0,r.kt)("li",{parentName:"ul"},"We ",(0,r.kt)("strong",{parentName:"li"},"don't enforce a low bandwidth"),": not possible to run full waku nodes in laptops acting as a centralization force, nodes are run by few professional operators in data centers, waku users just use light clients, network throughput can scale way easier, federated approach.")),(0,r.kt)("p",null,"So it's about where to draw this line."),(0,r.kt)("p",null,"Points to take into account:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Relay contributes to bandwidth the most"),": Relay is the protocol that mostly contributes to bandwidth usage, and it can't choose to allocate fewer bandwidth resources like other protocols (eg ",(0,r.kt)("inlineCode",{parentName:"li"},"store")," can choose to provide less resources and it will work). In other words, the network sets the relay bandwidth requirements, and if the node can't meet them, it just wont work."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Upload and download bandwidth are the same"),": Due to how gossipsub works, and hence ",(0,r.kt)("inlineCode",{parentName:"li"},"relay"),", the bandwidth consumption is symmetric, meaning that upload and download bandwidth is the same. This is because of ",(0,r.kt)("inlineCode",{parentName:"li"},"D")," and the reciprocity of the connections, meaning that one node upload is another download."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Nodes not meeting requirements can use light clients"),". Note that nodes not meeting the bandwidth requirements can still use waku, but they will have to use light protocols, which are a great alternative, especially on mobile, but with some drawbacks (trust assumptions, less reliability, etc)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Waku can't take all the bandwidth:")," Waku is meant to be used in conjunction with other services, so it shouldn't consume all the existing bandwidth. If Waku consumes ",(0,r.kt)("inlineCode",{parentName:"li"},"x Mbps")," and someone bandwidth is ",(0,r.kt)("inlineCode",{parentName:"li"},"x Mpbs"),", the UX won't be good."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Compare with existing well-known services:")," As shown in ",(0,r.kt)("em",{parentName:"li"},"Table ","[3]"),", Netflix 4K video streaming takes 15Mbps, so that is an order of magnitude to take into account.")),(0,r.kt)("p",null,"Coming up with a number:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Lowest average download speed across continents is Africa (26 Mbps)"),(0,r.kt)("li",{parentName:"ul"},"Lowest average upload speed across continents is Africa (17 Mbps)"),(0,r.kt)("li",{parentName:"ul"},"Since in waku the bandwidth consumption is symmetric, we are limited by the lowest (17 Mpbs)"),(0,r.kt)("li",{parentName:"ul"},"However waku should not consume all bandwidth, leaving some room for other applications."),(0,r.kt)("li",{parentName:"ul"},"We could set 10 Mbps, which is between Full HD video and 4K."),(0,r.kt)("li",{parentName:"ul"},"With 10Mbps the % of average bandwidth waku will consume is:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"North-America 9 %"),(0,r.kt)("li",{parentName:"ul"},"South-America 18 %"),(0,r.kt)("li",{parentName:"ul"},"Europe  11 %"),(0,r.kt)("li",{parentName:"ul"},"Asia 18 %"),(0,r.kt)("li",{parentName:"ul"},"Oceania 12 %"),(0,r.kt)("li",{parentName:"ul"},"Africa 38 %")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Conclusion:")," Limit to ",(0,r.kt)("inlineCode",{parentName:"p"},"10 Mbps")," each waku shard. How? Not trivial, see ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/waku-org/research/issues/22#issuecomment-1727795042"},"https://github.com/waku-org/research/issues/22#issuecomment-1727795042")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Note:")," This number is not set in stone and is subject to modifications, but it will most likely stay in the same order of magnitude if changed."))}m.isMDXComponent=!0}}]);